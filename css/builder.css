/* css/builder.css */

body.builder-body{
  min-height:100vh;
  background: var(--bg);
  color:#fff;
}

/* ===== Górny pasek / wrapper ===== */

.wrap{
  max-width: 1120px;
  margin: 0 auto;
}

.bar{
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap:16px;
  padding-top:20px;
  padding-bottom:14px;
  border-bottom:1px solid var(--line2);
}

.title{
  font-size:18px;
  font-weight:900;
  letter-spacing:.12em;
  text-transform:uppercase;
}

.hint{
  margin-top:4px;
  font-size:12px;
  opacity:.75;
}

.actions{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

/* ===== Parametry geometrii – jak w Twoim pliku, tylko kolory inne ===== */

:root {
  --radius: 16px;          /* promień dla wszystkiego (wypustka, kliny, karta) */
  --tab-width: 220px;      /* szerokość jednej zakładki (max) */
  --tab-height: 48px;      /* wysokość wypustki/paska */
  --tab-extra: 1px;        /* zwis wypustki na kartę */
  --corner-bottom: 0px;    /* położenie klina góra/dół */
  --corner-shift: 1px;     /* przesunięcie klina prawo/lewo */
  --border-fudge: 2px;     /* pozycja łuku obramowania */

  --page-bg: var(--bg);
  --surface: #111827;      /* PEŁNY, nieprzezroczysty kolor karty/wypustki */
  --inactive-text: rgba(255,255,255,.70);
  --border-color: var(--line2);
}

/* ===== Karty z wypustką – kształt 1:1 z Twoim demo ===== */

.tabs-card {
  width: 100%;
  margin: 16px auto 0;
  position: relative;
}

/* Pasek = wysokość wypustki, tekst w jednej linii */
.tabs-strip {
  display: flex;
  height: var(--tab-height);
  align-items: stretch;
  background: var(--page-bg);
  position: relative;
  z-index: 1;
}

/* trzy sloty obok siebie */
.tab-slot {
  position: relative;
  width: var(--tab-width);
  flex: 1 1 0;
  display: flex;
  align-items: stretch;
  justify-content: center;
}

/* Nieaktywna zakładka = tekst na tle paska */
.tab-label {
  position: relative;
  border: none;
  background: transparent;
  color: var(--inactive-text);
  width: 100%;
  height: var(--tab-height);
  line-height: var(--tab-height);
  font-size: 12px;
  font-weight: 800;
  letter-spacing: .08em;
  text-transform: uppercase;
  cursor: pointer;
  white-space: nowrap;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  margin: 0;
}

/* aktywna (JS dodaje .active) – tekst jaśniejszy */
.tab-label.active{
  color:#f9fafb;
}

/* hover nieaktywnych */
.tab-label:not(.active):hover{
  color:#ffffff;
}

/* separator między nieaktywnymi (sterowany niżej) */
.tab-label::after {
  content: "";
  position: absolute;
  left: 0;
  top: 8px;
  bottom: 8px;
  width: 1px;
  background: rgba(0,0,0,0.35);
  display: none;
}

/* separator NIGDY na aktywnej zakładce */
.tab-label.active::after{
  display:none !important;
}

/* podświetlenie nieaktywnych */
.tab-label::before {
  content: "";
  position: absolute;
  left: 6%;
  right: 6%;
  top: 14%;
  bottom: 14%;
  border-radius: calc(var(--radius) * 0.9);
  background: rgba(255,255,255,0.18);
  opacity: 0;
  pointer-events: none;
  transition: opacity .15s;
}

.tab-label:not(.active):hover::before {
  opacity: 1;
}

/* WYPUSTKA – lekko wydłużona, zakrywa border karty */

.tab-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  pointer-events: none;
  z-index: 2;
  display: none;
}

/* pokaż tylko przy aktywnej zakładce */
.tab-slot:has(.tab-label.active) .tab-wrapper {
  display:block;
}

.tab-active {
  height: calc(var(--tab-height) + var(--tab-extra));
  width: 100%;
  line-height: var(--tab-height); /* tekst trzyma się wizualnej wysokości */
  text-align: center;

  background: var(--surface);                 /* PEŁNY kolor */
  border: 1px solid var(--border-color);
  border-bottom: none;                        /* dół bez obramowania – zakrywa border karty */

  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  font-size: 12px;
  font-weight: 800;
  letter-spacing:.08em;
  text-transform:uppercase;
  color: #f9fafb;                             /* jasny tekst na ciemnym tle */
  position: relative;
  z-index: 2;
  pointer-events: auto;
}

/* KLINY – kształt + łuk obramowania */

.tab-corner {
  position: absolute;
  bottom: var(--corner-bottom);
  width: var(--radius);
  height: var(--radius);
  overflow: hidden;              /* ucina pełne kółko do ćwiartki */
  background-color: transparent;
  z-index: 3;
  pointer-events: none;
}

/* wypełnienie – luka, ale kolor = surface (też nieprzezroczysty) */
.tab-corner-left {
  left: 0;
  transform: translateX(calc(-100% + var(--corner-shift)));
  background-image: radial-gradient(
    circle at 0% 0%,
    transparent var(--radius),
    var(--surface) var(--radius)
  );
}

.tab-corner-right {
  right: 0;
  transform: translateX(calc(100% - var(--corner-shift)));
  background-image: radial-gradient(
    circle at 100% 0%,
    transparent var(--radius),
    var(--surface) var(--radius)
  );
}

/* łukowa ramka – pełne kółko przesunięte o border-fudge na zewnątrz */
.tab-corner::before {
  content: "";
  position: absolute;
  width: calc(2 * var(--radius));
  height: calc(2 * var(--radius));
  border-radius: 50%;
  border: 1px solid var(--border-color);
  background: transparent;
}

.tab-corner-left::before {
  top:  calc(-1 * var(--radius) - var(--border-fudge));
  left: calc(-1 * var(--radius) - var(--border-fudge));
}

.tab-corner-right::before {
  top:   calc(-1 * var(--radius) - var(--border-fudge));
  right: calc(-1 * var(--radius) - var(--border-fudge));
}

/* KLIN NA KRAWĘDZI:
   - przy pierwszej zakładce znika lewy
   - przy ostatniej zakładce znika prawy
*/

.tabs-card:has(#tabPollText.active) .slot-pollText .tab-corner-left{
  display:none;
}

.tabs-card:has(#tabPrepared.active) .slot-prepared .tab-corner-right{
  display:none;
}

/* ===== KARTA – jeden obiekt z obramowaniem ===== */

.builder-card.card {
  margin-top: 0;
  background: var(--surface);           /* ten sam kolor co wypustka */
  border: 1px solid var(--border-color);
  border-radius: var(--radius);
  padding: 18px 18px 14px;
  position: relative;
  z-index: 0;
  box-shadow: 0 18px 36px rgba(0,0,0,.45);
}

/* Rogi karty względem położenia wypustki */

.tabs-card:has(#tabPollText.active) .builder-card{
  border-top-left-radius: 0;
  border-top-right-radius: var(--radius);
}

.tabs-card:has(#tabPollPoints.active) .builder-card{
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
}

.tabs-card:has(#tabPrepared.active) .builder-card{
  border-top-left-radius: var(--radius);
  border-top-right-radius: 0;
}

/* Separatory tylko między nieaktywnymi:
   - gdy aktywny lewy → separator tylko między środkowym a prawym
   - gdy aktywny środkowy → brak separatorów
   - gdy aktywny prawy → separator tylko między lewym a środkowym
*/

.tabs-card:has(#tabPollText.active) .slot-prepared .tab-label::after{
  display:block;
}

.tabs-card:has(#tabPrepared.active) .slot-pollPoints .tab-label::after{
  display:block;
}

/* ===== GRID z grami ===== */

.grid{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap:14px;
}

/* Pojedyncza gra – JS tworzy div.card */

.builder-body .grid .card{
  position:relative;
  background:#070b16;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.22);
  padding:14px 14px 12px;
  cursor:pointer;
  transition:
    transform .12s ease-out,
    box-shadow .12s ease-out,
    border-color .12s ease-out,
    background .12s ease-out;
  overflow:hidden;

  display:flex;                  /* ujednolicenie wysokości */
  flex-direction:column;
  justify-content:space-between;
  min-height:130px;
}

/* X do usuwania */
.builder-body .grid .card .x{
  position:absolute;
  top:8px;
  right:10px;
  font-size:14px;
  opacity:.7;
}
.builder-body .grid .card .x:hover{
  opacity:1;
}

/* tytuł gry – jaśniejszy */

.builder-body .grid .card .name{
  font-weight:900;
  font-size:14px;
  letter-spacing:.06em;
  text-transform:uppercase;
  padding-right:22px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  color:#fdfdfd;
}

/* meta (typ + status) */

.builder-body .grid .card .meta{
  margin-top:6px;
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.08em;
  color:rgba(236,239,244,.9);
}

/* hover / selected */

.builder-body .grid .card:hover{
  transform: translateY(-2px);
  box-shadow: 0 10px 24px rgba(0,0,0,.45);
  border-color: var(--gold);
  background:#0b1020;
}

.builder-body .grid .card.selected{
  box-shadow: 0 0 0 2px var(--gold);
  border-color: var(--gold);
}

/* ===== Kafelek +Nowa gra – ta sama wysokość co reszta ===== */

.addCard{
  border-radius:18px;
  border:1px dashed rgba(255,234,166,.35);
  background: rgba(255,234,166,.06);
  padding:14px;
  min-height:130px;        /* tyle samo co .card */
  cursor:pointer;
  user-select:none;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:6px;
  text-align:center;
  transition:
    background .12s ease-out,
    border-color .12s ease-out,
    transform .12s ease-out,
    box-shadow .12s ease-out;
}

.addCard:hover{
  background: rgba(255,234,166,.10);
  border-color: rgba(255,234,166,.85);
  transform: translateY(-2px);
  box-shadow: 0 10px 24px rgba(0,0,0,.45);
}

.addCard .plus{
  font-size:28px;
  color: var(--gold);
  line-height:1;
}
.addCard .txt{
  font-weight:1000;
  letter-spacing:.06em;
}
.addCard .sub{
  opacity:.78;
  font-size:12px;
  line-height:1.35;
}

/* ===== Dół karty: import / eksport ===== */

.builder-bottom{
  margin-top:18px;
  padding-top:10px;
  border-top:1px solid rgba(255,255,255,.12);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
}

.builder-bottom-right{
  display:flex;
  gap:8px;
}

/* =========================================================
   MODAL + IMPORT (jak w editorze)
   (klasy overlay/modal/importRow/importTa/importMsg/mTitle/mSub)
========================================================= */

.overlay{
  position:fixed; inset:0;
  background: rgba(2,6,23,.82);
  display:grid;
  place-items:center;
  z-index:50;
}

.modal{
  width:min(860px,94vw);
  border-radius:22px;
  border:1px solid var(--line);
  background: var(--card);
  box-shadow:0 30px 90px rgba(0,0,0,.75);
  padding:18px;

  max-height:92vh;
  overflow:auto;
  -webkit-overflow-scrolling: touch;
}

.mTitle{
  font-weight:1000;
  font-size:18px;
  letter-spacing:.06em;
  color: var(--gold);
}

.mSub{
  opacity:.8;
  font-size:13px;
  margin-top:6px;
}

.importRow{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
  margin-top:12px;
}

.importTa{
  width:100%;
  min-height:220px;
  margin-top:12px;
  padding:12px;
  border-radius:16px;
  border:1px solid var(--line2);
  background: rgba(0,0,0,.25);
  color:#fff;
  outline:none;
  resize: vertical;
  font-weight:800;
}

.importMsg{
  margin-left:auto;
  opacity:.85;
  font-weight:900;
  color: var(--gold);
  padding:6px 0;
}

@media (max-width: 720px){

  :root{
    --tab-height: 56px;
    --tab-extra: 3px;
  }

  .tabs-strip{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap:0;
    /* overflow:hidden;  <-- USUŃ, bo ucina łuki */
  }

  .tab-slot{
    width:100%;
    flex:none;
    justify-content:center;
  }

  .tab-label{
    height: var(--tab-height);
    line-height: var(--tab-height);
  }

  .tab-active{
    height: calc(var(--tab-height) + var(--tab-extra));
    line-height: var(--tab-height);
    color: transparent; /* jak w control: wypustka bez tekstu */
    /* top: 1px; <-- USUŃ */
  }

  .tab-label::after,
  .tab-label.active::after{
    display:none !important;
  }

  .tab-corner{
    bottom: 2; /* było -1px -> cofamy */
  }

  /* warstwy jak w control */
  .tab-label{ z-index: 2; }
  .tab-wrapper{ z-index: 1; }

  .grid{ grid-template-columns: minmax(0, 1fr); }

  .builder-card.card{
    padding:14px 10px 10px;
    /* margin-top:-1px; <-- USUŃ, bo zjada górną obwódkę */
  }
}
