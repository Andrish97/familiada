/* css/builder.css */

/* =========================================================
   FIXED CARD LAYOUT (builder / bases / logo-editor list)
   - body nie scrolluje
   - main + karta majÄ… staÅ‚Ä… wysokoÅ›Ä‡ viewport
   - scroll jest WYÅÄ„CZNIE wewnÄ…trz .grid
   - .builder-bottom zawsze widoczny
========================================================= */

:root {
  --radius: 16px;
  --tab-width: 220px;
  --tab-height: 48px;
  --tab-extra: 1px;
  --corner-bottom: 0px;
  --corner-shift: 1px;
  --border-fudge: 2px;

  --page-bg: var(--bg);
  --surface: #111827;
  --inactive-text: rgba(255,255,255,.70);
  --border-color: var(--line2);
}

/* --- BODY / MAIN: viewport-locked + internal layout --- */
body.builder-body{
  height: 100vh;
  min-height: 100vh;
  background: var(--bg);
  color: #fff;

  display: flex;
  flex-direction: column;
  overflow: hidden;               /* ðŸ”‘ brak scrolla strony */
}

/* main.wrap musi byÄ‡ flex-kolumnÄ…, Å¼eby bar + shell weszÅ‚y w viewport */
body.builder-body > main.wrap{
  flex: 1 1 auto;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;               /* ðŸ”‘ scroll tylko w Å›rodku karty */
}

/* W builder.css masz wÅ‚asnÄ… .wrap â€“ zostawiamy max-width,
   ale przywracamy sensowny padding (Å¼eby nie lepiÅ‚o do krawÄ™dzi). */
.wrap{
  width: 100%;
  max-width: 1120px;
  margin: 0 auto;
  padding: 18px;
  box-sizing: border-box;
}

/* --- BAR (nagÅ‚Ã³wek listy) nie moÅ¼e rozpychaÄ‡ wysokoÅ›ci --- */
.bar{
  flex: 0 0 auto;

  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 16px;

  padding-top: 20px;
  padding-bottom: 14px;
  border-bottom: 1px solid var(--line2);
  margin-bottom: 12px;
}

.title{
  font-size: 18px;
  font-weight: 900;
  letter-spacing: .12em;
  text-transform: uppercase;
}

.hint{
  margin-top: 4px;
  font-size: 12px;
  opacity: .75;
}

.actions{
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin: 10px;
}

/* --- BUILDER SHELL: wypeÅ‚nia resztÄ™ ekranu --- */
.builder-shell{
  flex: 1 1 auto;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* =========================================================
   TABS CARD (builder)
========================================================= */
.tabs-card{
  width: 100%;
  margin: 16px auto 0;
  position: relative;

  /* ðŸ”‘ najwaÅ¼niejsze: tabs-card musi byÄ‡ flex-kolumnÄ… */
  flex: 1 1 auto;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.tabs-strip{
  flex: 0 0 auto;

  display: flex;
  height: var(--tab-height);
  align-items: stretch;
  background: var(--page-bg);
  position: relative;
  z-index: 1;
}

.tab-label,
.tab-slot{
  position: relative;
  display: flex;
  justify-content: center;
}

.tab-slot{
  width: var(--tab-width);
  flex: 1 1 0;
  align-items: stretch;
}

.tab-label{
  border: 0;
  background: transparent;
  color: var(--inactive-text);

  width: 100%;
  height: var(--tab-height);
  line-height: var(--tab-height);

  font-size: 12px;
  font-weight: 800;
  letter-spacing: .08em;
  text-transform: uppercase;

  cursor: pointer;
  white-space: nowrap;
  align-items: center;

  padding: 0;
  margin: 0;
}

.tab-label.active{ color: #f9fafb; }
.tab-label:not(.active):hover{ color: #fff; }

.tab-label::after{
  content: "";
  position: absolute;
  left: 0;
  top: 8px;
  bottom: 8px;
  width: 1px;
  background: rgba(0,0,0,.35);
  display: none;
}
.tab-label.active::after{ display: none !important; }

.tab-label::before{
  content: "";
  position: absolute;
  left: 6%;
  right: 6%;
  top: 14%;
  bottom: 14%;
  border-radius: calc(var(--radius)*.9);
  background: rgba(255,255,255,.18);
  opacity: 0;
  pointer-events: none;
  transition: opacity .15s;
}
.tab-label:not(.active):hover::before{ opacity: 1; }

.tab-wrapper{
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  pointer-events: none;
  z-index: 2;
  display: none;
}

/* Twoje warunki pokazywania wrappera */
.tab-slot:has(.tab-label.active) .tab-wrapper,
.tabs-card:has(#tabPollText.active) .slot-prepared .tab-label::after,
.tabs-card:has(#tabPrepared.active) .slot-pollPoints .tab-label::after{
  display: block;
}

.tab-active,
.tab-corner::before{
  border: 1px solid var(--border-color);
}

.tab-active{
  height: calc(var(--tab-height) + var(--tab-extra));
  width: 100%;
  line-height: var(--tab-height);
  text-align: center;

  background: var(--surface);
  border-bottom: none;
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);

  font-size: 12px;
  font-weight: 800;
  letter-spacing: .08em;
  text-transform: uppercase;
  color: #f9fafb;

  position: relative;
  z-index: 2;
  pointer-events: auto;
}

.tab-corner{
  position: absolute;
  bottom: var(--corner-bottom);
  width: var(--radius);
  height: var(--radius);
  overflow: hidden;
  background-color: transparent;
  z-index: 3;
  pointer-events: none;
}

.tab-corner-left{
  left: 0;
  transform: translateX(calc(-100% + var(--corner-shift)));
  background-image: radial-gradient(circle at 0% 0%, transparent var(--radius), var(--surface) var(--radius));
}

.tab-corner-right{
  right: 0;
  transform: translateX(calc(100% - var(--corner-shift)));
  background-image: radial-gradient(circle at 100% 0%, transparent var(--radius), var(--surface) var(--radius));
}

.tab-corner::before{
  content: "";
  position: absolute;
  width: calc(2 * var(--radius));
  height: calc(2 * var(--radius));
  border-radius: 50%;
  background: transparent;
}

.tab-corner-left::before{
  top: calc(-1 * var(--radius) - var(--border-fudge));
  left: calc(-1 * var(--radius) - var(--border-fudge));
}
.tab-corner-right::before{
  top: calc(-1 * var(--radius) - var(--border-fudge));
  right: calc(-1 * var(--radius) - var(--border-fudge));
}

.tabs-card:has(#tabPollText.active) .slot-pollText .tab-corner-left,
.tabs-card:has(#tabPrepared.active) .slot-prepared .tab-corner-right{
  display: none;
}

/* =========================================================
   BUILDER CARD: staÅ‚a wysokoÅ›Ä‡ + grid scroll + bottom fixed
========================================================= */
.card.builder-card,
.builder-card.card{
  margin-top: 0;
  background: var(--surface);
  border: 1px solid var(--border-color);
  border-radius: var(--radius);
  padding: 18px 18px 14px;
  position: relative;
  z-index: 0;
  box-shadow: 0 18px 36px rgba(0,0,0,.45);
  box-sizing: border-box;

  /* ðŸ”‘ klucz: karta jako flex-kolumna, wypeÅ‚nia resztÄ™ viewport */
  flex: 1 1 auto;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden; /* scroll ma byÄ‡ w .grid */
}

/* ZaokrÄ…glenia pod wypustki */
.tabs-card:has(#tabPollText.active) .builder-card{
  border-top-left-radius: 0;
  border-top-right-radius: var(--radius);
}
.tabs-card:has(#tabPollPoints.active) .builder-card{
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
}
.tabs-card:has(#tabPrepared.active) .builder-card{
  border-top-left-radius: var(--radius);
  border-top-right-radius: 0;
}

/* Grid staje siÄ™ scroll-contenerem */
.grid{
  flex: 1 1 auto;
  min-height: 0;
  overflow: auto;                 /* ðŸ”‘ tu jest scroll */
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 14px;
  align-content: start;           /* nie rozciÄ…ga w pionie */
  padding: 5px;             /* drobny luz na scrollbar */
  -webkit-overflow-scrolling: touch;
}

/* Kafelki w gridzie â€“ bez zmian funkcjonalnych */
.builder-body .grid .card{
  position: relative;
  background: #070b16;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.22);
  padding: 14px 14px 12px;
  cursor: pointer;
  transition: transform .12s ease-out, box-shadow .12s ease-out, border-color .12s ease-out, background .12s ease-out;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  min-height: 130px;
}

.builder-body .grid .card .x{
  position: absolute;
  top: 8px;
  right: 10px;
  font-size: 14px;
  opacity: .7;
}
.builder-body .grid .card .x:hover{ opacity: 1; }

.builder-body .grid .card .name{
  font-weight: 900;
  font-size: 14px;
  letter-spacing: .06em;
  text-transform: uppercase;
  padding-right: 22px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: #fdfdfd;
}
.builder-body .grid .card .meta{
  margin-top: 6px;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: .08em;
  color: rgba(236,239,244,.9);
}

.addCard:hover,
.builder-body .grid .card:hover{
  transform: translateY(-2px);
  box-shadow: 0 10px 24px rgba(0,0,0,.45);
}
.builder-body .grid .card:hover{
  border-color: var(--gold);
  background: #0b1020;
}
.builder-body .grid .card.selected{
  box-shadow: 0 0 0 2px var(--gold);
  border-color: var(--gold);
}

/* Add card */
.addCard{
  border-radius: 18px;
  border: 1px dashed rgba(255,234,166,.35);
  background: rgba(255,234,166,.06);
  padding: 14px;
  min-height: 130px;
  cursor: pointer;
  user-select: none;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 6px;
  text-align: center;
  transition: background .12s ease-out, border-color .12s ease-out, transform .12s ease-out, box-shadow .12s ease-out;
}
.addCard:hover{
  background: rgba(255,234,166,.1);
  border-color: rgba(255,234,166,.85);
}
.addCard .plus{
  font-size: 28px;
  color: var(--gold);
  line-height: 1;
}
.addCard .txt{
  font-weight: 1000;
  letter-spacing: .06em;
}
.addCard .sub{
  opacity: .78;
  font-size: 12px;
  line-height: 1.35;
}

/* Bottom zawsze widoczny: siedzi poza .grid i nie scrolluje */
.builder-bottom{
  flex: 0 0 auto;

  margin-top: 12px;               /* mniejszy odstÄ™p, bo grid juÅ¼ scrolluje */
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,.12);

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.builder-bottom-right{
  display: flex;
  gap: 8px;
}

/* =========================================================
   MODALS (jak byÅ‚o)
========================================================= */
.overlay{
  position: fixed;
  inset: 0;
  background: rgba(2,6,23,.82);
  display: grid;
  place-items: center;
  z-index: 50;
}

.modal{
  width: min(860px, 94vw);
  border-radius: 22px;
  border: 1px solid var(--line);
  background: var(--card);
  box-shadow: 0 30px 90px rgba(0,0,0,.85);
  padding: 18px;
  max-height: 92vh;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

.mTitle{
  font-weight: 1000;
  font-size: 18px;
  letter-spacing: .06em;
  color: var(--gold);
}
.mSub{
  opacity: .8;
  font-size: 13px;
  margin-top: 6px;
}

.importRow{
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
  margin-top: 12px;
}

.importTa{
  width: 100%;
  min-height: 220px;
  margin-top: 12px;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--line2);
  background: rgba(0,0,0,.25);
  color: #fff;
  outline: 0;
  resize: vertical;
  font-weight: 800;
}

.importMsg{
  margin-left: auto;
  opacity: .85;
  font-weight: 900;
  color: var(--gold);
  padding: 6px 0;
}

/* =========================================================
   MOBILE
========================================================= */
@media (max-width: 720px){
  :root{
    --tab-height: 56px;
    --tab-extra: 2px;
  }

  .tabs-strip{
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0;
  }

  .tab-slot{
    width: 100%;
    flex: none;
    justify-content: center;
  }

  .tab-active,
  .tab-label{
    line-height: var(--tab-height);
  }

  .tab-label{
    height: var(--tab-height);
    z-index: 2;
  }

  .tab-active{
    height: calc(var(--tab-height) + var(--tab-extra));
    color: transparent; /* jak byÅ‚o */
  }

  .tab-label.active::after,
  .tab-label::after{
    display: none !important;
  }

  .tab-wrapper{ z-index: 1; }

  .grid{
    grid-template-columns: minmax(0, 1fr);
  }
}